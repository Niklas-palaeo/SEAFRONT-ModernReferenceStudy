---
title: "Figures"
author: "Niklas Hausmann and Danai Theodoraki"
date: "Today"
output: pdf_document
---

# Libraries 
```{r Libraries,echo=FALSE,message = FALSE,warning = FALSE}
knitr::opts_chunk$set(echo=FALSE,message = FALSE,warning = FALSE)

{
  pacman::p_load(
    here,
    janitor,
    tidyverse,
    cowplot,ggx,
    patchwork,
    RColorBrewer,
    readxl) 
  
  theme_set(theme_cowplot())
}
```

# Data

```{r}

ElementSeasonData <- tibble(
  result = c('Preceding', 'Preceding/Actual', 'Actual', 'Subsequent/Actual','Subsequent', 'Uncertain'),
  count = c(9, 5, 96,0, 2, 10)
) %>% 
  mutate(result = factor(result, levels = c('Preceding', 'Preceding/Actual', 'Actual', 'Subsequent/Actual','Subsequent', 'Uncertain')),
        result = recode(result, 'Subsequent/Actual' = 'Subsequent/\nActual'),
                result = recode(result, 'Preceding/Actual' = 'Preceding/\nActual'))  # Insert newline


Offsets <- read_excel(here("data","calculations2.xlsx"), sheet = "Sheet3") %>% 
  pivot_longer(cols = everything(), names_to = "location", values_to = "sst") %>% 
  mutate(location = factor(location, levels = c("Faro Punta Sottile","Tonnara del Secco","Franchthi","Youra")))




```



# Fig. Results LIBS Seasons
```{r}

ElementSeasonData %>% 
  ggplot()+
  aes(result,count,fill=result)+
  geom_col(col="black",show.legend=FALSE)+
scale_fill_manual(
  values = c('Preceding' = '#d73027',        # Red shade
             'Preceding/\nActual' = '#fc8d59',  # Lighter red
             'Actual' = '#f7f7f7',            # Neutral (white-grey centre)
             'Subsequent/\nActual' = '#b2abd2', # Light purple/grey transition (for Subsequent/Actual)
             'Subsequent' = '#4575b4',        # Deeper blue for Subsequent
             'Uncertain' = 'darkgrey')        # Darker grey for Uncertain
)+
  labs(x="")


```



# Fig. Offsets
```{r}

ggplot(Offsets, aes(y = location, x = sst)) +
  geom_boxplot(width=0.2,show.legend=FALSE,outliers = FALSE)+
  geom_point(show.legend = FALSE) +
  geom_vline(xintercept = 0,linetype="dashed")+
  labs(y = "",
       x = "SST difference between instrumental and calcuated values [ÂºC]")

```

